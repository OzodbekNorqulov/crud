<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Page</title>
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous"
    />
    <style>
      body {
        text-transform: lowercase !important;
      }
      .anns {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
        gap: 1rem;
      }

      .open {
        display: block;
        position: absolute;
        left: -120px;
      }

      @media (max-width: 767.98px) {
        .card {
          width: 100% !important;
          margin-bottom: 20px;
        }
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-light bg-light">
      <div class="container-fluid">
        <a class="navbar-brand">Shop X</a>
        <div class="dropdown">
          <a
            style="
              cursor: pointer;
              width: 60px;
              height: 60px;
              border-radius: 50%;
              padding-top: 3px;
            "
            class="d-flex justify-content-center align-items-center btn btn-primary"
            href="#"
            role="button"
            id="dropdownMenuLink"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <h4 class="text-white mt-2">
              <%= locals.userName.slice(0, 1).toUpperCase() %>
            </h4>
          </a>

          <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            <li><a class="dropdown-item" href="/profile">My Profile</a></li>
            <li><a class="dropdown-item" href="/ads">My ads</a></li>
            <li><a class="dropdown-item" href="/ads/create">Create ads</a></li>
            <li><a class="dropdown-item" href="/form">Log Out</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <section>
      <div class="container-fluid">
        <div class="anns">
          <% locals.user.forEach(i => { %>
          <div class="card col-sm-12 col-xs-12" style="width: 18rem">
            <div class="card-body">
              <h5 class="card-title"><%= i.title %></h5>
              <p class="card-text"><%= i.description %></p>
            </div>
            <ul class="list-group list-group-flush">
              <li class="list-group-item"><%= i.model %></li>
              <li class="list-group-item"><%= i.price + "$" %></li>
              <li class="list-group-item"><%= i.case %></li>
            </ul>
            <h5 style="margin: 7px 5px">
              seller:
              <a
                class="btn btn-light" href=""><%=
                i.userName%></a
              >
            </h5>
            <div class="card-body">
              <a href="#" class="card-link">Card link</a>
              <a href="#" class="card-link">Another link</a>
            </div>
          </div>
          <% }) %>
        </div>
      </div>
    </section>
    <script>
      document.querySelector(".dropdown").addEventListener("click", (e) => {
        e.stopPropagation();
        document.querySelector(".dropdown-menu").classList.toggle("open");
      });

      document.body.addEventListener("click", () => {
        document.querySelector(".dropdown-menu").classList.remove("open");
      });

      document
        .querySelector(".dropdown-menu")
        .addEventListener("click", (e) => {
          e.stopPropagation();
        });

        let userBtns = document.querySelectorAll(".btn-light") 

        userBtns.forEach((i, idx) => {
          i.setAttribute("href", `chat/${idx}`)
          console.log(i);
        })

        
    </script>
  </body>
</html>
